# 🚀 eBay転売支援アプリ 開発ロードマップ

**プロジェクト:** Enhanced eBay Profit Calculator  
**最終更新:** 2024-08-20  
**バージョン:** v2.0  

---

## 📍 ハイレベル・マイルストーン（Roadmap）

| ID | マイルストーン | ステータス | 目標日 | 依存関係 | 完了条件 |
|---|---|---|---|---|---|
| STEP1 | 基礎利益計算ツール | ✅ 完了 | 2024-08-01 | - | URLから商品情報取得＋送料＋手数料＋利益計算 |
| STEP2 | リサーチ機能拡張 | ✅ 完了 | 2024-08-20 | STEP1 | タブ化UI＋検索＋CSV出力＋下書き保存モック |
| STEP3 | eBay API統合 | 🟡 進行中 | 2024-09-10 | API申請承認 | 実データ検索＋下書き実保存 |
| STEP4 | 配送計算高度化 | 🟡 進行中 | 2024-09-15 | - | 地帯別料金＋最安自動選択 |
| STEP5 | AIリライト機能 | ✅ 完了 | 2024-08-20 | OpenAI API | タイトル＋説明の市場最適化 |
| STEP6 | 手数料体系拡張 | ⏳ 未着手 | 2024-10-01 | STEP3 | カテゴリ別FVF＋国際手数料 |
| STEP7 | 監査・ログ強化 | ✅ 完了 | 2024-08-20 | - | JSONL形式＋操作履歴追跡 |
| STEP8 | データ管理機能 | 🟡 進行中 | 2024-09-20 | STEP2 | CSVインポート＋バックアップ |
| STEP9 | 運用・設定UI | ⏳ 未着手 | 2024-10-10 | STEP6 | 設定画面＋環境変数管理 |

---

## 📋 統合ToDoボード（Kanban風）

### 🔄 In Progress
- [ ] eBay API実データ検索機能 (STEP3-01 | P0 | 2024-09-05 | 依存: API承認)
- [ ] 日本郵便料金計算ロジック (STEP4-01 | P1 | 2024-09-01 | 依存: なし)
- [ ] CSVインポート機能 (STEP8-01 | P2 | 2024-09-10 | 依存: STEP2-04)

### 👀 Review
- [ ] リサーチタブUI最終調整 (STEP2-01 | P1 | 2024-08-25 | 依存: なし)
- [ ] 為替レート表示バッジ (STEP2-08 | P2 | 2024-08-25 | 依存: STEP2-02)

### ✅ Done
- [x] モジュラーアーキテクチャ設計 (ARCH-01 | P0 | 2024-08-20)
- [x] データソース抽象化 (ARCH-02 | P0 | 2024-08-20)
- [x] 為替レート取得＋キャッシュ (STEP2-02 | P0 | 2024-08-20)
- [x] 利益計算リアルタイム更新 (STEP2-03 | P0 | 2024-08-20)
- [x] CSV出力機能（選択行のみ） (STEP2-04 | P1 | 2024-08-20)
- [x] 下書き保存モック (STEP2-05 | P1 | 2024-08-20)
- [x] AIタイトルリライト (STEP5-01 | P1 | 2024-08-20)
- [x] 構造化ログ（JSONL） (STEP7-01 | P1 | 2024-08-20)

### 📚 Backlog
- [ ] カテゴリ別手数料設定 (STEP6-01 | P2 | 2024-10-01)
- [ ] 設定画面UI (STEP9-01 | P2 | 2024-10-10)
- [ ] バルク分析機能 (STEP10-01 | P3 | TBD)

---

## 🎯 機能別ワークストリーム

### 3.1 リサーチ機能（検索・一覧・CSV・為替）

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP2-01 | フィルタ・ソート機能強化 | オーナー | P1 | 2024-08-25 | なし | 価格帯・状態・利益率でフィルタ可能、ソート後も選択状態保持 | なし | 4h |
| STEP2-02 | 為替レート管理システム | オーナー | P0 | ✅完了 | なし | API障害時150円フォールバック、1時間キャッシュ動作確認 | なし | 6h |
| STEP2-03 | リアルタイム利益計算 | オーナー | P0 | ✅完了 | STEP2-02 | 仕入れ値入力で即座に利益額・率更新、手数料13%固定適用 | なし | 3h |
| STEP2-07 | セッション状態保持 | オーナー | P1 | 2024-08-30 | STEP2-01 | ページリロード・検索後もチェック状態維持 | なし | 2h |
| STEP2-08 | 為替レートUI表示 | オーナー | P2 | 2024-08-25 | STEP2-02 | リアルタイム/フォールバックをバッジで明示、タイムスタンプ表示 | なし | 2h |

### 3.2 出品下書き（ドラフト作成）

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP3-01 | eBay API認証フレームワーク | オーナー | P0 | 2024-09-05 | API承認 | OAuth2.0フロー、アクセストークン取得・更新 | API申請中 | 8h |
| STEP3-02 | Pydantic下書きモデル | オーナー | P0 | ✅完了 | なし | DraftPayload検証、必須フィールド・制約チェック | なし | 4h |
| STEP3-03 | 下書き実保存API接続 | オーナー | P1 | 2024-09-10 | STEP3-01 | eBay Selling APIでInventory作成、エラーハンドリング | API承認待ち | 12h |
| STEP2-05 | 下書き保存モック改善 | オーナー | P1 | ✅完了 | STEP3-02 | 選択商品を構造化JSON保存、一覧・削除機能 | なし | 6h |

### 3.3 AIリライト（タイトル/説明）

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP5-01 | OpenAIタイトルリライト | オーナー | P1 | ✅完了 | なし | 温度0.2、80文字以内、市場別最適化 | なし | 6h |
| STEP5-02 | 説明文自動生成 | オーナー | P1 | ✅完了 | STEP5-01 | 200-300語、HTMLタグなし、プロ仕様 | なし | 4h |
| STEP5-03 | リライトUI統合 | オーナー | P2 | 2024-09-01 | STEP5-01,02 | プレビュー表示、適用・再生成ボタン | なし | 4h |

### 3.4 送料計算（日本郵便レート）

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP4-01 | 配送ゾーン・料金CSV | オーナー | P1 | ✅完了 | なし | 60+国対応、地帯1-4分類、料金テーブル | なし | 4h |
| STEP4-02 | 最安配送選択ロジック | オーナー | P1 | 2024-09-01 | STEP4-01 | eパケット/小形包装物/EMS から自動選択 | なし | 6h |
| STEP4-03 | 重量自動推定 | オーナー | P2 | ✅完了 | なし | カテゴリ・タイトルベース、500g基準調整 | なし | 3h |
| STEP4-04 | 配送料UI改善 | オーナー | P2 | 2024-09-05 | STEP4-02 | 候補一覧表示、最安ハイライト | なし | 3h |

### 3.5 手数料・利益ロジック

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP6-01 | カテゴリ別FVF設定 | オーナー | P2 | 2024-10-01 | STEP3-01 | Electronics 8.75%、Motors 4%等、API連携 | なし | 8h |
| STEP6-02 | 国際手数料対応 | オーナー | P3 | 2024-10-15 | STEP6-01 | PayPal・Payoneer手数料、通貨別設定 | なし | 6h |

### 3.6 設定/環境（.env、キー管理）

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP9-01 | 設定画面UI | オーナー | P2 | 2024-10-10 | STEP6-01 | 環境変数読み取り、マスク表示、一部設定変更 | なし | 8h |
| STEP9-02 | キー検証機能 | オーナー | P1 | 2024-09-15 | STEP3-01 | API接続テスト、有効性チェック | なし | 4h |

### 3.7 ログ/監査（JSONL）

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP7-01 | 構造化ログシステム | オーナー | P1 | ✅完了 | なし | JSONL形式、時刻・セッション・操作種別記録 | なし | 6h |
| STEP7-02 | ログ分析ダッシュボード | オーナー | P2 | 2024-09-20 | STEP7-01 | 日次統計、エラー率、検索傾向表示 | なし | 8h |

### 3.8 CSV入出力

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP2-04 | CSV出力機能 | オーナー | P1 | ✅完了 | なし | 選択行のみ、UTF-8、改行・カンマエスケープ | なし | 4h |
| STEP8-01 | CSVインポート機能 | オーナー | P2 | 2024-09-10 | STEP2-04 | 以前の調査結果復元、データ整合性チェック | なし | 6h |

### 3.9 UI/UX（st.data_editor、フィルタ/ソート）

| ID | タスク | 担当 | 優先度 | 期日 | 依存 | 受け入れ基準 | ブロッカー | 所要目安 |
|---|---|---|---|---|---|---|---|---|
| STEP2-01 | データエディタ強化 | オーナー | P1 | 2024-08-25 | なし | フィルタ・ソート後も選択保持、カラム幅調整 | なし | 4h |
| STEP2-06 | モックデータ拡張 | オーナー | P2 | ✅完了 | なし | 10件以上、多様なカテゴリ・価格帯 | なし | 2h |

---

## 🔗 依存関係マップ（Dependencies）

### クリティカルパス
**STEP2 → STEP3 → STEP6**: リサーチ基盤 → API統合 → 手数料高度化

### 主要依存関係
- **STEP3-01,03**: eBay API申請承認待ち（外部依存）
- **STEP4-02**: STEP4-01（配送ゾーンCSV）完了後
- **STEP5-03**: STEP5-01,02（AIリライト機能）完了後  
- **STEP6-01**: STEP3-01（eBay API認証）完了後
- **STEP7-02**: STEP7-01（基礎ログ）完了後
- **STEP8-01**: STEP2-04（CSV出力）完了後
- **STEP9-01**: STEP6-01（手数料設定）完了後

### 並行実行可能
- STEP4（配送）とSTEP5（AI）は独立実行可能
- STEP7（ログ）とSTEP8（CSV）は独立実行可能

---

## 📅 7日間の実行計画（Weekly Plan）

### Day 1 (2024-08-21) - UI調整・バグ修正
**ゴール**: リサーチタブの使い勝手向上
- [ ] STEP2-01: フィルタ・ソート機能テスト・調整 (2h)
- [ ] STEP2-08: 為替レートバッジ実装 (2h)
- [ ] バグ修正・統合テスト (2h)
**完了条件**: フィルタ後も選択状態保持、レートバッジ表示

### Day 2 (2024-08-22) - 配送計算強化  
**ゴール**: 日本郵便料金の高精度計算
- [ ] STEP4-02: 最安配送選択ロジック実装 (4h)
- [ ] STEP4-04: 配送料UI表示改善 (2h)
- [ ] テストケース作成・実行 (2h)
**完了条件**: 3配送方法から最安自動選択、UI候補表示

### Day 3 (2024-08-23) - AIリライトUI統合
**ゴール**: リライト機能のユーザビリティ向上
- [ ] STEP5-03: リライトプレビューUI (3h)
- [ ] 再生成・適用ボタン (2h)
- [ ] エラーハンドリング強化 (1h)
**完了条件**: プレビュー表示、適用前確認可能

### Day 4 (2024-08-24) - eBay API準備
**ゴール**: API統合の下地作り
- [ ] STEP3-01: OAuth2.0認証フレームワーク (4h)
- [ ] モック→実API切り替え設計 (2h)
- [ ] API接続テスト準備 (2h)
**完了条件**: 認証フロー完成、本番切り替え可能

### Day 5 (2024-08-25) - セッション管理・状態保持
**ゴール**: UXの一貫性確保
- [ ] STEP2-07: セッション状態保持実装 (3h)
- [ ] ページ遷移テスト (2h)
- [ ] エッジケース対応 (1h)
**完了条件**: 検索・フィルタ後も選択状態維持

### Day 6 (2024-08-26) - CSVインポート
**ゴール**: データ管理機能拡張
- [ ] STEP8-01: CSVインポート実装 (4h)
- [ ] データ整合性チェック (2h)
- [ ] インポート→エクスポート往復テスト (2h)
**完了条件**: 過去データ復元、エラー検出・報告

### Day 7 (2024-08-27) - 統合テスト・リリース準備
**ゴール**: 品質保証・デプロイ準備
- [ ] 全機能統合テスト (3h)
- [ ] パフォーマンステスト (2h)
- [ ] ドキュメント更新 (1h)
- [ ] デプロイ準備・確認 (2h)
**完了条件**: 全テスト合格、デプロイ可能状態

---

## ⚠️ リスク&対策（Risks & Mitigations）

### 1. eBay API申請遅延
**リスク**: 本番API使用開始が遅れる  
**対策**: モック機能で開発継続、API承認後すぐ切り替え可能な設計維持

### 2. OpenAI APIコスト超過
**リスク**: AI機能の利用でコスト増加  
**対策**: 呼び出し回数制限、キャッシュ機能、フォールバック（手動入力）

### 3. 為替レートAPI障害
**リスク**: 円換算が不正確になる  
**対策**: ✅実装済み - 固定150円フォールバック、定期バックアップAPI

### 4. 日本郵便料金改定
**リスク**: 配送料計算が実際と乖離  
**対策**: CSV外部化済み、定期更新フロー策定、差分アラート

### 5. Streamlitパフォーマンス限界
**リスク**: 大量データでUI遅延  
**対策**: ページネーション、遅延読み込み、キャッシュ戦略

### 6. セキュリティ・APIキー漏洩
**リスク**: 認証情報の意図しない公開  
**対策**: ✅実装済み - Streamlit Secrets、環境変数、.gitignore強化

---

## 📊 進捗サマリ（Progress Summary）

### 現在の状況（2024-08-20）
- **完了**: 8タスク (47%)
- **進行中**: 3タスク (18%)  
- **未着手**: 6タスク (35%)

### 今週の完了目標
- STEP2-01: フィルタ・ソート強化
- STEP2-08: 為替レートUI  
- STEP4-02: 最安配送選択
- STEP5-03: AIリライトUI

### 次の意思決定ポイント

#### 1. eBay API選択（2024-09-01）
**検討事項**: Trading API vs Selling API vs Browse API  
**判断基準**: 下書き保存機能、手数料取得、利用制限

#### 2. UIフレームワーク移行検討（2024-10-01）
**検討事項**: Streamlit継続 vs Dash/FastAPI+React移行  
**判断基準**: パフォーマンス、カスタマイズ性、開発効率

#### 3. 収益化戦略（2024-11-01）
**検討事項**: 個人利用継続 vs SaaS化 vs API提供  
**判断基準**: ユーザー数、運用コスト、市場ニーズ

---

## 🔄 更新履歴

| 日付 | 更新者 | 変更内容 |
|---|---|---|
| 2024-08-20 | オーナー | 初版作成、モジュラー化完了反映 |
| 2024-08-21 | オーナー | 7日間計画詳細化 |

---

**🎯 次のレビュー予定: 2024-08-27**  
**📧 問い合わせ: プロジェクトオーナー**
